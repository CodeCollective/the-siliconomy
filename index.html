<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>A-Frame VR Scene</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- A-Frame (latest) -->
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <!-- Controller support -->
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/webxr-polyfill@latest/build/webxr-polyfill.js"></script>

    <!-- Physics system -->
    <script src="https://cdn.jsdelivr.net/npm/@c-frame/physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>

    <link rel="stylesheet" href="styles.css">  
  </head>

  <body>
    <div class="loading-indicator" id="loadingIndicator">Loading models...</div>

    <div class="instructions">
      <strong>Controls:</strong><br />
      • Desktop: WASD to move, Mouse to look, Click and drag to move models<br />
      • VR: Use thumbstick/trackpad to move, grab objects with trigger<br />
      • Look around by moving your head/mouse
    </div>

    <a-scene
      physics="gravity: -9.800"
      embedded
      style="height: 100vh; width: 100vw"
      vr-mode-ui="enabled: true"
      background="color: #87CEEB"
      renderer="antialias: true"
      cursor="rayOrigin: mouse"
    >
      <!-- Camera at ~1.600m eye height -->
      <a-entity position="0 1.600 4.000" simple-movement>
        <a-camera>
          <a-cursor raycaster="objects: .clickable"></a-cursor>
        </a-camera>
        
        <!-- Refresh Button (positioned 500mm in front) -->

        <a-entity 
          id="refresh-button"
          geometry="primitive: box; width: .200; height: .050; depth: .050"
          material="color: #FF6B6B"
          position="0 0 -0.500"
          class="clickable"
          clickable
        >
          <a-entity
            text="value: Refresh; align: center; width: 0.500; color: black"
            position="0 0 0.026" 
          ></a-entity>
        </a-entity>


      </a-entity>

      <!-- Model container -->
      <a-entity id="model-container"></a-entity>

      <!-- Controllers with visual representation -->
      <!-- Right Controller -->
      <a-entity hand-controls="hand: right"
                vive-controls="hand: right"
                raycaster="far: 20.000; objects: .clickable" 
                position="0.200 1.500 -0.300">
      </a-entity>

      <!-- Left Controller -->
      <a-entity hand-controls="hand: left"
                vive-controls="hand: left"
                raycaster="far: 20; objects: .clickable"
                position="-0.200 1.500 -0.300">
      </a-entity>

      <!-- Lighting  -->
      <a-light
        type="directional"
        intensity="1.5"
        position="1000 3000 1000"
        shadow="cast: true"
      ></a-light>
      <a-light
        type="directional"
        intensity="1.5"
        position="-1000 3000 1000"
        shadow="cast: true"
      ></a-light>
      <a-light type="ambient" intensity="1.4" color="#FFFFFF"></a-light>
      <a-light
        type="point"
        intensity="0.3"
        position="0 3 0"
        color="#ffffff"
      ></a-light>

      <!-- Sky -->
      <a-sky color="#87CEEB"></a-sky>

      <!-- Controller visibility management -->
      <script src = "./aframe_viewer.js"></script>
  </body>
</html>
